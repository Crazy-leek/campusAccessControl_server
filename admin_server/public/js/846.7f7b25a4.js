"use strict";(self["webpackChunkadmin"]=self["webpackChunkadmin"]||[]).push([[846],{5298:function(t,e,s){s.d(e,{Z:function(){return c}});var o=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:1==this.aType?"添加学生账号":"添加教师账号","show-close":!1,"close-on-click-modal":!1,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[e("el-form",{ref:"form",attrs:{model:t.form,"status-icon":"",rules:t.rules,"label-width":t.formLabelWidth}},[e("el-form-item",{attrs:{label:"姓名",prop:"name"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name","string"===typeof e?e.trim():e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"账号",prop:"account"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.account,callback:function(e){t.$set(t.form,"account","string"===typeof e?e.trim():e)},expression:"form.account"}})],1),e("el-form-item",{attrs:{label:"密码",prop:"password"}},[e("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password","string"===typeof e?e.trim():e)},expression:"form.password"}})],1),e("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[e("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:t.form.checkPass,callback:function(e){t.$set(t.form,"checkPass","string"===typeof e?e.trim():e)},expression:"form.checkPass"}})],1),e("el-form-item",{attrs:{label:"选择班级"}},[e("el-select",{attrs:{clearable:"",placeholder:"请选择班级"},model:{value:t.form.classID,callback:function(e){t.$set(t.form,"classID",e)},expression:"form.classID"}},t._l(t.options,(function(s){return e("el-option",{key:s.id,attrs:{"v-if":t.options.length>0,label:s.name,value:s.id}})})),1)],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.cancel}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")])],1)],1)},a=[],l={name:"AccountDialog",props:["dialogFormVisible","options","aType"],data(){let t=(t,e,s)=>{""===e?s(new Error("请输入密码")):e.length<6?s(new Error("请输入至少6位密码")):(""!==this.form.checkPass&&this.$refs.form.validateField("checkPass"),s())},e=(t,e,s)=>{""===e?s(new Error("请再次输入密码")):e!=this.form.password?s(new Error("两次输入密码不一致!")):s()},s=(t,e,s)=>{if(!e)return s(new Error("账号不能为空"));let o=8;if(1==this.aType&&(o=10),e.length!=o)return s(new Error(`请输入${o}位数的账号`));setTimeout((()=>{/^\d*$/.test(e)?s():s(new Error("请输入数字型账号"))}),1e3)};return{form:{account:"",name:"",password:"",checkPass:"",classID:""},show:!1,formLabelWidth:"120px",rules:{password:[{validator:t,trigger:"blur",required:!0}],checkPass:[{validator:e,trigger:"blur",required:!0}],account:[{validator:s,trigger:"blur",required:!0}],name:[{message:"姓名不能为空",trigger:"blur",required:!0}]}}},methods:{submitForm(){this.$refs.form.validate((t=>{t?(this.form.classID||(this.form.classID=void 0),this.$emit("onSubmit",{...this.form})):console.log("error submit!!")}))},cancel(){this.$emit("closeDialog")}},watch:{dialogFormVisible:function(){this.dialogFormVisible||this.$refs.form.resetFields()}}},r=l,i=s(1001),n=(0,i.Z)(r,o,a,!1,null,null,null),c=n.exports},6043:function(t,e,s){s.d(e,{Z:function(){return c}});var o=function(){var t=this,e=t._self._c;return e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[e("span",{staticClass:"el-dropdown-link"},[t._v(" "+t._s(t.title)),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.selection.length?t._e():e("div",{staticClass:"placeholder"},[t._v("无数据")]),t._l(t.selection,(function(s){return e("el-dropdown-item",{key:s.id,attrs:{"v-if":0!=t.selection.length,command:s.account||s.id,icon:t.icon}},[t._v(" "+t._s(s.name)+" ")])}))],2)],1)},a=[],l={name:"DropDown",props:{title:{typeof:"String",default:""},icon:{typeof:"String",default:"el-icon-s-custom"},selection:{typeof:"Array",default:()=>[]},infoID:{typeof:"String",default:""},additionalID:{typeof:"String",default:null}},methods:{handleCommand(t){this.$emit("choose",{infoID:this.infoID,chooseID:t,additionalID:this.additionalID||void 0})}}},r=l,i=s(1001),n=(0,i.Z)(r,o,a,!1,null,"4488ff44",null),c=n.exports},3846:function(t,e,s){s.r(e),s.d(e,{default:function(){return m}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"students"},[e("el-card",{staticClass:"stu-header mag-bottom"},[e("div",{staticClass:"add-search flex-between"},[e("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:t.showForm}},[t._v("添加学生")]),e("div",[e("span",[t._v("按班级过滤：")]),e("el-select",{attrs:{disabled:!t.classes.length,placeholder:"请选择班级"},model:{value:t.classID,callback:function(e){t.classID=e},expression:"classID"}},[e("el-option",{attrs:{label:"全部",value:"-1"}}),t.classes.length>0?e("el-option",{attrs:{label:"未分班",value:"0"}}):t._e(),t._l(t.classes,(function(s){return e("el-option",{key:s.id,attrs:{"v-if":t.classes.length>0,label:s.name,value:s.id}})}))],2)],1)],1)]),e("el-card",{staticClass:"stu-content"},[e("table",{staticClass:"table table-striped table-hover"},[e("thead",{staticClass:"thead-dark"},[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("姓名")]),e("th",{attrs:{scope:"col"}},[t._v("学号/账号")]),e("th",{attrs:{scope:"col"}},[t._v("所在班级")]),e("th",{attrs:{scope:"col"}},[t._v("操作")])])]),e("tbody",t._l(t.students,(function(s){return e("tr",{key:s.id,attrs:{"v-if":t.students.length>0}},[e("td",{attrs:{scope:"row"}},[t._v(t._s(s.name))]),e("td",[t._v(t._s(s.account))]),e("td",[t._v(t._s(s.cname||"暂未分班"))]),e("td",[e("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(e){return t.delStudent(s.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除学生账号")])],1),e("DropDown",{staticClass:"mag",attrs:{title:"修改所属班级",selection:t.classes.filter((t=>t.id!=s.classID)),infoID:s.id,icon:"el-icon-s-home"},on:{choose:t.alterStudent}})],1)])})),0)]),0==t.students.length?e("div",{staticClass:"table-placeholder"},[t._v("无信息")]):t._e()]),e("AccountDialog",{attrs:{dialogFormVisible:t.showed,options:t.classes,aType:1},on:{onSubmit:t.addStudent,closeDialog:t.closeForm}})],1)},a=[],l=s(7877),r=s(6043),i=s(5298),n={name:"Students",components:{AccountDialog:i.Z,DropDown:r.Z},created(){this.getData(),this.$store.state.classes.length||this.$store.dispatch("getClasses"),this.$bus.$on("reGetStudent",(()=>this.classID="-1"))},data(){return{showed:!1,classID:"-1"}},methods:{getData(){let t={};"-1"!=this.classID&&(t={classID:this.classID}),this.$store.dispatch("getStudents",t)},showForm(){this.showed=!0},closeForm(){this.showed=!1},async addStudent(t){console.log(t);const e=await l.Z.addStudent(t).catch((()=>{}));200==e.code?(this.$message.success("添加成功"),this.getData(),this.showed=!1):(console.log(e),this.$message.error(e.message))},async delStudent(t){const e=await l.Z.deleteStudent({id:t}).catch((()=>{}));200==e.code?(this.$message.success("删除成功"),this.getData()):(console.log(e),this.$message.error(e.message))},async alterStudent(t){let e={id:t.infoID,classID:t.chooseID};const s=await l.Z.alertStudent(e).catch((()=>{}));200==s.code?(this.$message.success("修改成功"),this.getData()):(console.log(s),this.$message.error(s.message))}},computed:{classes:function(){return this.$store.state.classes},students:function(){return this.$store.state.students}},watch:{classID:function(){this.getData()}}},c=n,d=s(1001),u=(0,d.Z)(c,o,a,!1,null,"60e602c2",null),m=u.exports}}]);
//# sourceMappingURL=846.7f7b25a4.js.map