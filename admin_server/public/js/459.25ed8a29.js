"use strict";(self["webpackChunkadmin"]=self["webpackChunkadmin"]||[]).push([[459],{5298:function(e,t,s){s.d(t,{Z:function(){return n}});var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:1==this.aType?"添加学生账号":"添加教师账号","show-close":!1,"close-on-click-modal":!1,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":e.formLabelWidth}},[t("el-form-item",{attrs:{label:"姓名",prop:"name"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"账号",prop:"account"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account","string"===typeof t?t.trim():t)},expression:"form.account"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password","string"===typeof t?t.trim():t)},expression:"form.password"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[t("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:e.form.checkPass,callback:function(t){e.$set(e.form,"checkPass","string"===typeof t?t.trim():t)},expression:"form.checkPass"}})],1),t("el-form-item",{attrs:{label:"选择班级"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择班级"},model:{value:e.form.classID,callback:function(t){e.$set(e.form,"classID",t)},expression:"form.classID"}},e._l(e.options,(function(s){return t("el-option",{key:s.id,attrs:{"v-if":e.options.length>0,label:s.name,value:s.id}})})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1)},o=[],a={name:"AccountDialog",props:["dialogFormVisible","options","aType"],data(){let e=(e,t,s)=>{""===t?s(new Error("请输入密码")):t.length<6?s(new Error("请输入至少6位密码")):(""!==this.form.checkPass&&this.$refs.form.validateField("checkPass"),s())},t=(e,t,s)=>{""===t?s(new Error("请再次输入密码")):t!=this.form.password?s(new Error("两次输入密码不一致!")):s()},s=(e,t,s)=>{if(!t)return s(new Error("账号不能为空"));let r=8;if(1==this.aType&&(r=10),t.length!=r)return s(new Error(`请输入${r}位数的账号`));setTimeout((()=>{/^\d*$/.test(t)?s():s(new Error("请输入数字型账号"))}),1e3)};return{form:{account:"",name:"",password:"",checkPass:"",classID:""},show:!1,formLabelWidth:"120px",rules:{password:[{validator:e,trigger:"blur",required:!0}],checkPass:[{validator:t,trigger:"blur",required:!0}],account:[{validator:s,trigger:"blur",required:!0}],name:[{message:"姓名不能为空",trigger:"blur",required:!0}]}}},methods:{submitForm(){this.$refs.form.validate((e=>{e?(this.form.classID||(this.form.classID=void 0),this.$emit("onSubmit",{...this.form})):console.log("error submit!!")}))},cancel(){this.$emit("closeDialog")}},watch:{dialogFormVisible:function(){this.dialogFormVisible||this.$refs.form.resetFields()}}},l=a,i=s(1001),c=(0,i.Z)(l,r,o,!1,null,null,null),n=c.exports},1459:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"teachers"},[t("el-card",{staticClass:"tc-head mag-bottom"},[t("div",{staticClass:"add-search flex-between"},[t("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:e.showForm}},[e._v("添加教师")]),t("el-input",{staticStyle:{width:"260px"},attrs:{placeholder:"请输入教师名字关键词","prefix-icon":"el-icon-search",clearable:!0},model:{value:e.keyword,callback:function(t){e.keyword="string"===typeof t?t.trim():t},expression:"keyword"}})],1)]),t("el-card",{staticClass:"tc-content"},[t("table",{staticClass:"table table-striped table-hover"},[t("thead",{staticClass:"thead-dark"},[t("tr",[t("th",{attrs:{scope:"col"}},[e._v("姓名")]),t("th",{attrs:{scope:"col"}},[e._v("工号/账号")]),t("th",{attrs:{scope:"col"}},[e._v("管理班级")]),t("th",{attrs:{scope:"col"}},[e._v("操作")])])]),t("tbody",e._l(e.teachers,(function(s){return t("tr",{key:s.id,attrs:{"v-if":e.teachers.length>0}},[t("td",{attrs:{scope:"row"}},[e._v(e._s(s.name))]),t("td",[e._v(e._s(s.account))]),t("td",[e._v(e._s(s.cname||"暂无"))]),t("td",[t("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(t){return e.delTeacher(s.id,s.classID)}}},[t("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v("删除教师账号")])],1)],1)])})),0)]),0==e.teachers.length?t("div",{staticClass:"table-placeholder"},[e._v("无信息")]):e._e()]),t("AccountDialog",{attrs:{dialogFormVisible:e.showed,options:e.classes,aType:0},on:{closeDialog:e.closeForm,onSubmit:e.addTeacher}})],1)},o=[],a=s(7877),l=s(5298),i={name:"Teachers",components:{AccountDialog:l.Z},data(){return{showed:!1,keyword:""}},created(){this.$store.state.teachers.length||this.getData()},methods:{getData(){this.$store.dispatch("getTeachers"),this.$store.dispatch("getClasses")},showForm(){this.showed=!0},closeForm(){this.showed=!1},async addTeacher(e){console.log(e);const t=await a.Z.addTeacher(e).catch((()=>{}));200==t.code?(this.$message.success("添加成功"),this.getData(),this.showed=!1):(console.log(t),this.$message.error(t.message))},async delTeacher(e,t){const s=await a.Z.deleteTeacher({id:e,classID:t}).catch((()=>{}));200==s.code?(this.$message.success("删除成功"),t?this.getData():this.$store.dispatch("getTeachers")):(console.log(s),this.$message.error(s.message))}},computed:{teachers:function(){return this.$store.state.teachers},classes:function(){return this.$store.state.classes.filter((e=>!e.tcID))}},watch:{keyword:function(){this.$timer&&clearTimeout(this.$timer),this.$timer=setTimeout((()=>{this.$store.dispatch("getTeachers",{keyword:this.keyword}),this.$timer=null}),800)}}},c=i,n=s(1001),m=(0,n.Z)(c,r,o,!1,null,"39bcff51",null),h=m.exports}}]);
//# sourceMappingURL=459.25ed8a29.js.map